package account_test

import (
	"bytes"
	"testing"

	"github.com/stretchr/testify/require"

	"github.com/bloxapp/eth2-key-manager/cli/cmd"
	"github.com/bloxapp/eth2-key-manager/cli/util/printer"
)

func TestAccountDepositData(t *testing.T) {
	t.Run("Successfully retrieve deposit-data", func(t *testing.T) {
		var output bytes.Buffer
		cmd.ResultPrinter = printer.New(&output)
		cmd.RootCmd.SetArgs([]string{
			"wallet",
			"account",
			"deposit-data",
			"--public-key=81fd26fe6e7cdbe1d0d45020050ba94c625f5236bf162b9ad3fca137d9120a0572c6f59b8cc70fae6cd6bb471b673e97",
			"--storage=7b226163636f756e7473223a2237623232333633343339333933323338333833393264333133323635363132643334333733383635326433383636333836343264363436323636333633373631333136333334333233393632323233613762323236323631373336353431363336333666373536653734353036313734363832323361323232663330323232633232363936343232336132323336333433393339333233383338333932643331333236353631326433343337333836353264333836363338363432643634363236363336333736313331363333343332333936323232326332323665363136643635323233613232363136333633366637353665373432643330323232633232373636313663363936343631373436393666366534623635373932323361376232323639363432323361323236363631363636313333363533303334326436363338333433373264333436353636363432643339333433363333326436323335333833333333333733313631363236333635363232323263323237303631373436383232336132323664326633313332333333383331326633333336333033303266333032663330326633303232326332323730373236393736346236353739323233613232333536333338333636343333363236343636333933383632363233343337363533363634363133303332333636353333333636363631363433353330363236313633363333383330333536333333333333323635363136333330333433383634363336363338333233353633333533313336333236313633333736333333333232323764326332323737363937343638363437323631373736313663353037353632346236353739323233613232333833383336333633383632333536313633333236333339363436313331333533333333333433343331363336363337363133333636363633363632363433373338363433393631333236333635363133373337363136333337333036343632363633393339333836333334333636333336363333343633363233373631333733373336363633333333333033333337363333323339333533363332363333363330333233373336333233373337363236353336333933373339333933383331323237643764222c226174744d656d6f7279223a2237623764222c226e6574776f726b223a223664363136393665222c2270726f706f73616c4d656d6f7279223a2237623764222c2277616c6c6574223a223762323236393634323233613232333636333338333333363335333333373264333833353336363232643334363136343633326436313631333733323264333636353339333933353636363133373636333933393339323232633232363936653634363537383464363137303730363537323232336137623232333833313636363433323336363636353336363533373633363436323635333136343330363433343335333033323330333033353330363236313339333436333336333233353636333533323333333636323636333133363332363233393631363433333636363336313331333333373634333933313332333036313330333533373332363333363636333533393632333836333633333733303636363136353336363336343336363236323334333733313632333633373333363533393337323233613232333633343339333933323338333833393264333133323635363132643334333733383635326433383636333836343264363436323636333633373631333136333334333233393632323237643263323237343739373036353232336132323438343432323764227d",
		})
		err := cmd.RootCmd.Execute()
		actualOutput := output.String()
		require.NotNil(t, actualOutput)
		require.NoError(t, err)
	})
}
